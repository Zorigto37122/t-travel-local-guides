"""seed excursions

Revision ID: 202602111215
Revises: 202602111200
Create Date: 2026-02-11 12:15:00.000000

"""

from typing import Sequence, Union

from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision: str = "202602111215"
down_revision: Union[str, Sequence[str], None] = "202602111200"
branch_labels: Union[str, Sequence[str], None] = None
depends_on: Union[str, Sequence[str], None] = None


EXCURSIONS = [
    # Москва
    ("Вечерняя прогулка по огням Москвы", "Россия", "Москва", "легко", 12, "Откройте для себя Москву в её самом романтичном облике! Мы пройдёмся по историческому центру столицы, когда город озаряется тысячами огней. Маршрут включает Красную площадь, набережную Москвы-реки, парк Зарядье и знаменитые мосты. Вы узнаете интересные факты о вечерней жизни города, истории освещения столицы и современных архитектурных решениях. Экскурсия идеально подходит для романтических прогулок и фотосессий. Продолжительность: 2-2.5 часа. Удобная обувь приветствуется!", 1500.0),
    ("Московский Кремль и Красная площадь", "Россия", "Москва", "средне", 15, "Погрузитесь в историю России через её главные символы! Мы посетим Московский Кремль — древнейшую крепость столицы, где хранятся сокровища русских царей и императоров. Вы увидите знаменитые соборы, Царь-пушку и Царь-колокол, а также посетите один из музеев Кремля. На Красной площади узнаете историю Собора Василия Блаженного, Мавзолея и ГУМа. Экскурсия включает профессионального гида с глубокими знаниями истории. Рекомендуется для первого знакомства с Москвой. Продолжительность: 3-4 часа.", 3500.0),
    ("Сталинские высотки: архитектурное путешествие", "Россия", "Москва", "средне", 10, "Откройте секреты сталинского ампира! Мы посетим все семь знаменитых высоток Москвы, построенных в стиле «сталинских небоскрёбов». Вы узнаете историю их строительства, архитектурные особенности и легенды, связанные с этими зданиями. Посетим здание МГУ на Воробьёвых горах, гостиницу «Украина», дом на Котельнической набережной и другие. Экскурсия включает внешний осмотр и посещение доступных общественных пространств. Для любителей архитектуры и истории. Продолжительность: 3 часа.", 2800.0),
    ("По следам Булгакова: Патриаршие и окрестности", "Россия", "Москва", "легко", 8, "Погрузитесь в мистический мир «Мастера и Маргариты»! Мы пройдём по местам, описанным в знаменитом романе Михаила Булгакова. Посетим Патриаршие пруды, где началась история романа, дом 302-бис на Садовой, где жил Булгаков, и другие знаковые места. Вы узнаете реальные истории, которые легли в основу романа, и увидите Москву глазами писателя. Экскурсия включает рассказы о жизни Булгакова в Москве и его творчестве. Идеально для поклонников литературы. Продолжительность: 2.5 часа.", 2200.0),
    ("Музеи Москвы за один день", "Россия", "Москва", "сложно", 20, "Интенсивное погружение в культурное наследие столицы! Мы посетим Третьяковскую галерею с её богатейшей коллекцией русской живописи, Исторический музей с экспозицией о России, и один из специализированных музеев на выбор (например, Пушкинский музей или Музей современного искусства). Вы увидите шедевры Репина, Сурикова, Васнецова и других великих художников. Экскурсия включает профессионального искусствоведа и предварительное бронирование билетов. Для ценителей искусства и культуры. Продолжительность: 6-7 часов с перерывами.", 5000.0),
    # Санкт‑Петербург
    ("Белые ночи на Неве", "Россия", "Санкт-Петербург", "легко", 18, "Уникальное природное явление белых ночей в самом романтичном городе России! Мы пройдёмся по набережным Невы, когда солнце почти не заходит за горизонт, создавая неповторимую атмосферу. Вы увидите разводные мосты, дворцовую набережную, стрелку Васильевского острова и Петропавловскую крепость в особенном освещении. Узнаете историю строительства города на болотах и как белые ночи влияли на жизнь петербуржцев. Экскурсия включает рассказы о традициях празднования белых ночей. Идеально для романтиков и фотографов. Продолжительность: 3 часа, начинается в 22:00.", 3000.0),
    ("Петербург Достоевского", "Россия", "Санкт-Петербург", "средне", 10, "Погрузитесь в мрачный и загадочный Петербург великого писателя! Мы посетим места, где жил и творил Фёдор Михайлович Достоевский, а также локации из его знаменитых романов «Преступление и наказание» и «Идиот». Вы увидите дом Раскольникова, Сенную площадь, каналы и дворы-колодцы, которые так ярко описаны в произведениях. Узнаете о жизни писателя в Петербурге, его творческом процессе и влиянии города на его произведения. Экскурсия включает посещение музея-квартиры Достоевского. Для любителей литературы и истории. Продолжительность: 3.5 часа.", 2600.0),
    ("Крыши Петербурга с видом на Исаакиевский", "Россия", "Санкт-Петербург", "средне", 6, "Захватывающий вид на исторический центр с высоты птичьего полёта! Мы поднимемся на одну из доступных крыш в центре города, откуда открывается панорамный вид на Исаакиевский собор, Неву, Зимний дворец и другие знаменитые достопримечательности. Вы сделаете потрясающие фотографии и узнаете историю архитектуры Петербурга с необычного ракурса. Экскурсия проводится с соблюдением всех мер безопасности профессиональным гидом. Подходит для любителей экстремальных фотосессий. Продолжительность: 2 часа. Ограничение по возрасту: 12+.", 3200.0),
    ("Загородные дворцы: Петергоф и Царское Село", "Россия", "Санкт-Петербург", "сложно", 25, "Дворцовое великолепие императорской России за один день! Мы посетим Петергоф — жемчужину русского барокко с его знаменитыми фонтанами и парками, а затем отправимся в Царское Село, где находится Екатерининский дворец с Янтарной комнатой. Вы увидите роскошные интерьеры, парковые ансамбли и узнаете историю жизни русских императоров. Экскурсия включает трансфер, входные билеты и профессионального гида. Обед в одном из ресторанов на территории. Для ценителей истории и архитектуры. Продолжительность: 8-9 часов.", 6500.0),
    ("Ночная экскурсия по разводным мостам", "Россия", "Санкт-Петербург", "легко", 14, "Зрелищное представление разведения мостов над Невой! Мы посетим лучшие точки наблюдения за разводкой Дворцового, Троицкого и других знаменитых мостов. Вы увидите, как огромные пролёты поднимаются вверх, пропуская крупные суда, и узнаете историю и технические особенности этого уникального процесса. Экскурсия проходит в период навигации (апрель-ноябрь) и включает рассказы о речном судоходстве и архитектуре мостов. Идеально для фотографов и любителей техники. Продолжительность: 2-3 часа, начинается в 00:30.", 2700.0),
    # Казань
    ("Казанский кремль и старая Татарская слобода", "Россия", "Казань", "легко", 16, "Знакомство с историей Казани и культурой татар.", 2400.0),
    ("Остров‑град Свияжск", "Россия", "Казань", "средне", 20, "Поездка к живописному острову на Волге.", 3800.0),
    ("Современная Казань: набережная и IT‑кварталы", "Россия", "Казань", "легко", 12, "Гуляем по новой Казани и её бизнес‑центрам.", 2100.0),
    ("Казанская кухня: гастротур по ресторанам", "Россия", "Казань", "легко", 10, "Пробуем чак‑чак, эчпочмаки и другие блюда.", 3500.0),
    # Сочи
    ("Сочи: от морского порта до Ривьеры", "Россия", "Сочи", "легко", 20, "Прогулка по центральному Сочи у моря.", 2300.0),
    ("Красная Поляна: горные виды и канатные дороги", "Россия", "Сочи", "средне", 18, "Поездка в горы с подъёмом на канатке.", 5200.0),
    ("33 водопада и тисо‑самшитовая роща", "Россия", "Сочи", "средне", 15, "Природные достопримечательности Сочинского района.", 4100.0),
    ("Дегустация вина на побережье", "Россия", "Сочи", "легко", 12, "Винодельни и обзорные площадки у моря.", 3600.0),
    # Нижний Новгород
    ("Нижегородский кремль и Чкаловская лестница", "Россия", "Нижний Новгород", "легко", 16, "Главные символы города за пару часов.", 1900.0),
    ("Стрелка Оки и Волги", "Россия", "Нижний Новгород", "легко", 14, "Прогулка по набережным с видами на слияние рек.", 2100.0),
    ("Горький и нижегородские купцы", "Россия", "Нижний Новгород", "средне", 12, "История знаменитых купеческих династий.", 2500.0),
    # Екатеринбург
    ("Екатеринбург: от старого центра до небоскрёбов", "Россия", "Екатеринбург", "легко", 18, "Контраст дореволюционной и современной архитектуры.", 2600.0),
    ("Граница Европы и Азии", "Россия", "Екатеринбург", "легко", 20, "Поездка к символической границе двух частей света.", 3300.0),
    ("Конструктивизм Урала", "Россия", "Екатеринбург", "средне", 10, "Маршрут по памятникам конструктивизма.", 2900.0),
    # Новосибирск
    ("Новосибирский Академгородок", "Россия", "Новосибирск", "легко", 15, "Научный центр Сибири и его история.", 2700.0),
    ("Обь и старый центр Новосибирска", "Россия", "Новосибирск", "легко", 14, "Гуляем по набережной и главным улицам.", 2200.0),
]


def upgrade() -> None:
  conn = op.get_bind()

  # создаём технического гида, если его нет
  user_id = conn.execute(
      sa.text(
          "INSERT INTO users (name, phone, email, hashed_password, is_active, is_superuser, is_verified) "
          "VALUES ('Тестовый гид', '+79990000000', 'guide@example.com', '$2b$12$abcdefghijklmnopqrstuv', true, false, true) "
          "ON CONFLICT (email) DO UPDATE SET name = EXCLUDED.name "
          "RETURNING id"
      )
  ).scalar_one()

  guide_id = conn.execute(
      sa.text(
          "INSERT INTO guides (user_id) VALUES (:user_id) "
          "ON CONFLICT (user_id) DO UPDATE SET user_id = EXCLUDED.user_id "
          "RETURNING guide_id"
      ),
      {"user_id": user_id},
  ).scalar_one()

  # добавляем экскурсии
  for title, country, city, difficulty, slots, description, price in EXCURSIONS:
      conn.execute(
          sa.text(
              "INSERT INTO excursions "
              "(title, country, city, difficulty, description, photos, price_per_person, "
              "accepted_payment_methods, status, available_slots, guide_id) "
              "VALUES "
              "(:title, :country, :city, :difficulty, :description, '', :price, "
              "'online,cash', 'approved', :slots, :guide_id)"
          ),
          {
              "title": title,
              "country": country,
              "city": city,
              "difficulty": difficulty,
              "description": description,
              "price": price,
              "slots": slots,
              "guide_id": guide_id,
          },
      )


def downgrade() -> None:
  conn = op.get_bind()
  titles = [e[0] for e in EXCURSIONS]
  conn.execute(
      sa.text("DELETE FROM excursions WHERE title = ANY(:titles)"),
      {"titles": titles},
  )

